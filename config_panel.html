<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCS AI Answerer - é…ç½®ç®¡ç†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .nav-tabs {
            display: flex;
            background: #f5f7fa;
            border-bottom: 2px solid #e4e7ed;
            overflow-x: auto;
        }

        .nav-tab {
            flex: 1;
            min-width: 150px;
            padding: 15px 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 16px;
            color: #606266;
            transition: all 0.3s;
            font-weight: 500;
            position: relative;
        }

        .nav-tab:hover {
            background: #e8eaf0;
            color: #409eff;
        }

        .nav-tab.active {
            color: #409eff;
            background: white;
        }

        .nav-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #409eff;
        }

        .content {
            padding: 30px;
        }

        .tab-pane {
            display: none;
            animation: fadeIn 0.3s;
        }

        .tab-pane.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #409eff;
        }

        .section-title {
            font-size: 1.3em;
            color: #303133;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: #606266;
            font-weight: 500;
            font-size: 14px;
        }

        .form-help {
            display: block;
            margin-top: 5px;
            color: #909399;
            font-size: 12px;
            line-height: 1.5;
        }

        .form-input,
        .form-select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #dcdfe6;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.3s;
            background: white;
        }

        .form-input:focus,
        .form-select:focus {
            outline: none;
            border-color: #409eff;
            box-shadow: 0 0 0 3px rgba(64, 158, 255, 0.1);
        }

        .form-input[type="number"] {
            width: 200px;
        }

        .form-input.small {
            width: 150px;
        }

        .switch-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #dcdfe6;
            transition: 0.3s;
            border-radius: 26px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #409eff;
        }

        input:checked + .slider:before {
            transform: translateX(24px);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: #67c23a;
            color: white;
        }

        .btn-success:hover {
            background: #85ce61;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(103, 194, 58, 0.4);
        }

        .btn-secondary {
            background: #909399;
            color: white;
        }

        .btn-secondary:hover {
            background: #a6a9ad;
        }

        .btn-warning {
            background: #e6a23c;
            color: white;
        }

        .btn-warning:hover {
            background: #ebb563;
        }

        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 6px;
            margin-bottom: 20px;
            display: none;
            animation: slideDown 0.3s;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .alert-success {
            background: #f0f9ff;
            border-left: 4px solid #67c23a;
            color: #67c23a;
        }

        .alert-error {
            background: #fef0f0;
            border-left: 4px solid #f56c6c;
            color: #f56c6c;
        }

        .alert-warning {
            background: #fdf6ec;
            border-left: 4px solid #e6a23c;
            color: #e6a23c;
        }

        .card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.2em;
            color: #303133;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-online {
            background: #f0f9ff;
            color: #67c23a;
        }

        .status-offline {
            background: #fef0f0;
            color: #f56c6c;
        }

        .quick-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .quick-link-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-decoration: none;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quick-link-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .quick-link-icon {
            font-size: 2em;
        }

        .quick-link-title {
            font-size: 1.2em;
            font-weight: 600;
        }

        .quick-link-desc {
            opacity: 0.9;
            font-size: 0.9em;
        }

        .config-preview {
            background: #f5f7fa;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #909399;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #409eff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .info-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 3px solid #409eff;
        }

        .info-label {
            font-size: 12px;
            color: #909399;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 18px;
            color: #303133;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .container {
                margin: 0;
                border-radius: 0;
            }
            
            .content {
                padding: 15px;
            }
            
            .quick-links {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– OCS AI Answerer</h1>
            <p>æ™ºèƒ½ç­”é¢˜ç³»ç»Ÿ - é…ç½®ç®¡ç†ä¸­å¿ƒ</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('home')">ğŸ  é¦–é¡µ</button>
            <button class="nav-tab" onclick="switchTab('model')">ğŸ§  æ¨¡å‹é…ç½®</button>
            <button class="nav-tab" onclick="switchTab('reasoning')">ğŸ’¡ æ€è€ƒæ¨¡å¼</button>
            <button class="nav-tab" onclick="switchTab('parameters')">âš™ï¸ AIå‚æ•°</button>
            <button class="nav-tab" onclick="switchTab('network')">ğŸŒ ç½‘ç»œè®¾ç½®</button>
            <button class="nav-tab" onclick="switchTab('system')">ğŸ”§ ç³»ç»Ÿé…ç½®</button>
            <button class="nav-tab" onclick="switchTab('preview')">ğŸ“‹ é…ç½®é¢„è§ˆ</button>
        </div>

        <div class="content">
            <div id="alert-container"></div>

            <!-- é¦–é¡µ -->
            <div id="home" class="tab-pane active">
                <div class="card">
                    <div class="card-title">ç³»ç»ŸçŠ¶æ€</div>
                    <div class="info-grid">
                        <div class="info-item">
                            <div class="info-label">æœåŠ¡çŠ¶æ€</div>
                            <div class="info-value">
                                <span id="status-badge" class="status-badge status-offline">æ£€æŸ¥ä¸­...</span>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">æœåŠ¡åœ°å€</div>
                            <div class="info-value" id="service-url">-</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">å½“å‰æ¨¡å‹</div>
                            <div class="info-value" id="current-model">-</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">æ€è€ƒæ¨¡å¼</div>
                            <div class="info-value" id="reasoning-status">-</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">å¿«é€Ÿå¯¼èˆª</div>
                    <div class="quick-links">
                        <a href="/viewer" target="_blank" class="quick-link-card">
                            <div class="quick-link-icon">ğŸ“Š</div>
                            <div class="quick-link-title">ç­”é¢˜è®°å½•</div>
                            <div class="quick-link-desc">æŸ¥çœ‹å†å²ç­”é¢˜æ•°æ®å’Œç»Ÿè®¡å›¾è¡¨</div>
                        </a>
                        <a href="/api/docs" target="_blank" class="quick-link-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            <div class="quick-link-icon">ğŸ“š</div>
                            <div class="quick-link-title">APIæ–‡æ¡£</div>
                            <div class="quick-link-desc">æŸ¥çœ‹APIæ¥å£æ–‡æ¡£å’Œä½¿ç”¨è¯´æ˜</div>
                        </a>
                        <a href="javascript:void(0)" onclick="switchTab('model')" class="quick-link-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                            <div class="quick-link-icon">âš¡</div>
                            <div class="quick-link-title">å¿«é€Ÿé…ç½®</div>
                            <div class="quick-link-desc">é…ç½®AIæ¨¡å‹å’Œç­”é¢˜å‚æ•°</div>
                        </a>
                        <a href="javascript:void(0)" onclick="testConnection()" class="quick-link-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                            <div class="quick-link-icon">ğŸ”Œ</div>
                            <div class="quick-link-title">è¿æ¥æµ‹è¯•</div>
                            <div class="quick-link-desc">æµ‹è¯•ä¸OCSç³»ç»Ÿçš„è¿æ¥çŠ¶æ€</div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- æ¨¡å‹é…ç½® -->
            <div id="model" class="tab-pane">
                <div class="section">
                    <div class="section-title">æ¨¡å‹æä¾›å•†</div>
                    <div class="form-group">
                        <label class="form-label">æä¾›å•†é€‰æ‹©</label>
                        <select id="MODEL_PROVIDER" class="form-select">
                            <option value="auto">è‡ªåŠ¨é€‰æ‹©ï¼ˆæ™ºèƒ½è·¯ç”±ï¼‰</option>
                            <option value="deepseek">DeepSeek</option>
                            <option value="doubao">è±†åŒ… (Doubao)</option>
                        </select>
                        <span class="form-help">è‡ªåŠ¨æ¨¡å¼ä¼šæ ¹æ®é¢˜ç›®ç±»å‹æ™ºèƒ½é€‰æ‹©æœ€åˆé€‚çš„æ¨¡å‹</span>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">æ™ºèƒ½æ¨¡å‹é€‰æ‹©</div>
                    <div class="form-group">
                        <div class="switch-group">
                            <label class="switch">
                                <input type="checkbox" id="AUTO_MODEL_SELECTION">
                                <span class="slider"></span>
                            </label>
                            <label class="form-label">å¯ç”¨æ™ºèƒ½é€‰æ‹©</label>
                        </div>
                        <span class="form-help">æ ¹æ®é¢˜ç›®å†…å®¹è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ¨¡å‹ï¼ˆä»…åœ¨æä¾›å•†ä¸º"auto"æ—¶ç”Ÿæ•ˆï¼‰</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">çº¯æ–‡æœ¬é¢˜ç›®é¦–é€‰æ¨¡å‹</label>
                        <select id="PREFER_MODEL" class="form-select">
                            <option value="deepseek">DeepSeekï¼ˆæˆæœ¬ä½ã€é€Ÿåº¦å¿«ï¼‰</option>
                            <option value="doubao">è±†åŒ…</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">å›¾ç‰‡é¢˜ç›®ä½¿ç”¨æ¨¡å‹</label>
                        <select id="IMAGE_MODEL" class="form-select">
                            <option value="doubao">è±†åŒ…ï¼ˆæ”¯æŒå¤šæ¨¡æ€ï¼‰</option>
                            <option value="deepseek">DeepSeek</option>
                        </select>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">DeepSeek é…ç½®</div>
                    <div class="form-group">
                        <label class="form-label">API Key</label>
                        <input type="password" id="DEEPSEEK_API_KEY" class="form-input" placeholder="sk-...">
                        <span class="form-help">è·å–åœ°å€: https://platform.deepseek.com/api_keys</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">API Base URL</label>
                        <input type="text" id="DEEPSEEK_BASE_URL" class="form-input" placeholder="https://api.deepseek.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">æ¨¡å‹åç§°</label>
                        <select id="DEEPSEEK_MODEL" class="form-select">
                            <option value="deepseek-chat">deepseek-chatï¼ˆé€šç”¨å¯¹è¯ï¼‰</option>
                            <option value="deepseek-reasoner">deepseek-reasonerï¼ˆæ·±åº¦æ¨ç†ï¼‰</option>
                        </select>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">è±†åŒ… (Doubao) é…ç½®</div>
                    <div class="form-group">
                        <label class="form-label">API Key</label>
                        <input type="password" id="DOUBAO_API_KEY" class="form-input" placeholder="your-api-key">
                        <span class="form-help">è·å–åœ°å€: https://console.volcengine.com/ark</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">API Base URL</label>
                        <input type="text" id="DOUBAO_BASE_URL" class="form-input" placeholder="https://ark.cn-beijing.volces.com/api/v3">
                    </div>
                    <div class="form-group">
                        <label class="form-label">æ¨ç†æ¥å…¥ç‚¹ID</label>
                        <input type="text" id="DOUBAO_MODEL" class="form-input" placeholder="doubao-seed-1-6-251015">
                        <span class="form-help">åœ¨è±†åŒ…æ§åˆ¶å°åˆ›å»ºæ¨ç†æ¥å…¥ç‚¹åè·å¾—</span>
                    </div>
                </div>
            </div>

            <!-- æ€è€ƒæ¨¡å¼é…ç½® -->
            <div id="reasoning" class="tab-pane">
                <div class="section">
                    <div class="section-title">å…¨å±€æ€è€ƒæ¨¡å¼</div>
                    <div class="form-group">
                        <div class="switch-group">
                            <label class="switch">
                                <input type="checkbox" id="ENABLE_REASONING">
                                <span class="slider"></span>
                            </label>
                            <label class="form-label">å¯ç”¨æ¨ç†æ¨¡å¼ï¼ˆå…¨å±€ï¼‰</label>
                        </div>
                        <span class="form-help">å¯ç”¨åæ‰€æœ‰é¢˜ç›®éƒ½ä½¿ç”¨æ·±åº¦æ¨ç†æ¨¡å¼ï¼ˆDeepSeekè‡ªåŠ¨åˆ‡æ¢åˆ°deepseek-reasonerï¼‰</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">æ€è€ƒå¼ºåº¦ï¼ˆä»…è±†åŒ…ï¼‰</label>
                        <select id="REASONING_EFFORT" class="form-select">
                            <option value="low">ä½å¼ºåº¦ï¼ˆå¿«é€Ÿï¼‰</option>
                            <option value="medium">ä¸­ç­‰å¼ºåº¦ï¼ˆå¹³è¡¡ï¼‰</option>
                            <option value="high">é«˜å¼ºåº¦ï¼ˆæ·±åº¦ï¼‰</option>
                        </select>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">è‡ªåŠ¨æ€è€ƒè§¦å‘</div>
                    <div class="form-group">
                        <div class="switch-group">
                            <label class="switch">
                                <input type="checkbox" id="AUTO_REASONING_FOR_MULTIPLE">
                                <span class="slider"></span>
                            </label>
                            <label class="form-label">å¤šé€‰é¢˜è‡ªåŠ¨å¯ç”¨æ·±åº¦æ€è€ƒ</label>
                        </div>
                        <span class="form-help">å¤šé€‰é¢˜é€šå¸¸æ›´å¤æ‚,å»ºè®®å¯ç”¨</span>
                    </div>
                    <div class="form-group">
                        <div class="switch-group">
                            <label class="switch">
                                <input type="checkbox" id="AUTO_REASONING_FOR_IMAGES">
                                <span class="slider"></span>
                            </label>
                            <label class="form-label">å¸¦å›¾ç‰‡é¢˜ç›®è‡ªåŠ¨å¯ç”¨æ·±åº¦æ€è€ƒ</label>
                        </div>
                        <span class="form-help">å›¾ç‰‡é¢˜ç›®é€šå¸¸éœ€è¦æ›´å¤æ‚çš„åˆ†æ</span>
                    </div>
                </div>
            </div>

            <!-- AIå‚æ•°é…ç½® -->
            <div id="parameters" class="tab-pane">
                <div class="section">
                    <div class="section-title">åŸºç¡€å‚æ•°</div>
                    <div class="form-group">
                        <label class="form-label">æ¸©åº¦å‚æ•° (Temperature)</label>
                        <input type="number" id="TEMPERATURE" class="form-input small" min="0" max="2" step="0.1" placeholder="0.1">
                        <span class="form-help">èŒƒå›´: 0.0-2.0ã€‚æ¨èç­”é¢˜ä½¿ç”¨ 0.1-0.3ï¼ˆæ›´ç¡®å®šï¼‰ï¼Œå¯¹è¯ä½¿ç”¨ 0.4-0.7</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Top-P æ ¸é‡‡æ ·</label>
                        <input type="number" id="TOP_P" class="form-input small" min="0" max="1" step="0.05" placeholder="0.95">
                        <span class="form-help">èŒƒå›´: 0.0-1.0ã€‚æ¨è 0.9-1.0ï¼Œæ§åˆ¶è¯æ±‡é€‰æ‹©çš„å¤šæ ·æ€§</span>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">Tokené™åˆ¶</div>
                    <div class="form-group">
                        <label class="form-label">æœ€å¤§è¾“å‡ºTokenæ•°ï¼ˆæ™®é€šæ¨¡å¼ï¼‰</label>
                        <input type="number" id="MAX_TOKENS" class="form-input small" min="1" max="8192" placeholder="500">
                        <span class="form-help">èŒƒå›´: 1-8192ã€‚é€‰æ‹©é¢˜æ¨è 300-500ï¼Œå¤æ‚é¢˜ç›®å¯å¢åŠ åˆ° 1000+</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">æœ€å¤§è¾“å‡ºTokenæ•°ï¼ˆæ€è€ƒæ¨¡å¼ï¼‰</label>
                        <input type="number" id="REASONING_MAX_TOKENS" class="form-input small" min="1" max="65536" placeholder="4096">
                        <span class="form-help">èŒƒå›´: 1-65536ã€‚æ€è€ƒæ¨¡å¼éœ€è¦æ›´å¤§ç©ºé—´ï¼Œæ¨è 4096-8000</span>
                    </div>
                </div>
            </div>

            <!-- ç½‘ç»œè®¾ç½® -->
            <div id="network" class="tab-pane">
                <div class="section">
                    <div class="section-title">ä»£ç†é…ç½®</div>
                    <div class="form-group">
                        <label class="form-label">HTTP ä»£ç†</label>
                        <input type="text" id="HTTP_PROXY" class="form-input" placeholder="http://127.0.0.1:7890">
                        <span class="form-help">å¯é€‰ã€‚æ ¼å¼: http://host:port æˆ– socks5://host:port</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">HTTPS ä»£ç†</label>
                        <input type="text" id="HTTPS_PROXY" class="form-input" placeholder="http://127.0.0.1:7890">
                        <span class="form-help">å¯é€‰ã€‚é€šå¸¸ä¸HTTPä»£ç†ç›¸åŒ</span>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">è¿æ¥å‚æ•°</div>
                    <div class="form-group">
                        <label class="form-label">è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰</label>
                        <input type="number" id="TIMEOUT" class="form-input small" min="10" max="3600" placeholder="180">
                        <span class="form-help">APIè¯·æ±‚çš„æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œæ¨è 60-300 ç§’</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">æœ€å¤§é‡è¯•æ¬¡æ•°</label>
                        <input type="number" id="MAX_RETRIES" class="form-input small" min="0" max="10" placeholder="3">
                        <span class="form-help">è¯·æ±‚å¤±è´¥æ—¶çš„é‡è¯•æ¬¡æ•°</span>
                    </div>
                </div>
            </div>

            <!-- ç³»ç»Ÿé…ç½® -->
            <div id="system" class="tab-pane">
                <div class="section">
                    <div class="section-title">æœåŠ¡é…ç½®</div>
                    <div class="form-group">
                        <label class="form-label">ç›‘å¬åœ°å€</label>
                        <input type="text" id="HOST" class="form-input small" placeholder="0.0.0.0">
                        <span class="form-help">0.0.0.0 è¡¨ç¤ºç›‘å¬æ‰€æœ‰ç½‘å¡ï¼Œ127.0.0.1 è¡¨ç¤ºä»…æœ¬åœ°è®¿é—®</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ç›‘å¬ç«¯å£</label>
                        <input type="number" id="PORT" class="form-input small" min="1" max="65535" placeholder="5000">
                        <span class="form-help">å»ºè®®ä½¿ç”¨ 5000-9999 ä¹‹é—´çš„ç«¯å£</span>
                    </div>
                    <div class="form-group">
                        <div class="switch-group">
                            <label class="switch">
                                <input type="checkbox" id="DEBUG">
                                <span class="slider"></span>
                            </label>
                            <label class="form-label">è°ƒè¯•æ¨¡å¼</label>
                        </div>
                        <span class="form-help">å¯ç”¨åä¼šè¾“å‡ºè¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ï¼ˆç”Ÿäº§ç¯å¢ƒè¯·å…³é—­ï¼‰</span>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">æ—¥å¿—é…ç½®</div>
                    <div class="form-group">
                        <label class="form-label">CSVæ—¥å¿—æ–‡ä»¶è·¯å¾„</label>
                        <input type="text" id="CSV_LOG_FILE" class="form-input" placeholder="ocs_answers_log.csv">
                        <span class="form-help">ç­”é¢˜è®°å½•ä¿å­˜çš„æ–‡ä»¶åï¼ˆç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ï¼‰</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">æ—¥å¿—çº§åˆ«</label>
                        <select id="LOG_LEVEL" class="form-select">
                            <option value="DEBUG">DEBUGï¼ˆè°ƒè¯•ï¼‰</option>
                            <option value="INFO">INFOï¼ˆä¿¡æ¯ï¼‰</option>
                            <option value="WARNING">WARNINGï¼ˆè­¦å‘Šï¼‰</option>
                            <option value="ERROR">ERRORï¼ˆé”™è¯¯ï¼‰</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- é…ç½®é¢„è§ˆ -->
            <div id="preview" class="tab-pane">
                <div class="section">
                    <div class="section-title">å½“å‰é…ç½®ï¼ˆ.envæ ¼å¼ï¼‰</div>
                    <div id="config-preview" class="config-preview">åŠ è½½ä¸­...</div>
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="copyConfig()">ğŸ“‹ å¤åˆ¶é…ç½®</button>
                        <button class="btn btn-secondary" onclick="downloadConfig()">ğŸ’¾ ä¸‹è½½ä¸º.envæ–‡ä»¶</button>
                        <button class="btn btn-warning" onclick="loadConfig()">ğŸ”„ åˆ·æ–°é¢„è§ˆ</button>
                    </div>
                </div>
            </div>

            <!-- æ“ä½œæŒ‰é’® -->
            <div class="btn-group" style="margin-top: 30px; position: sticky; bottom: 20px; background: white; padding: 15px 0; border-top: 1px solid #e4e7ed;">
                <button class="btn btn-success" onclick="saveConfig()">ğŸ’¾ ä¿å­˜é…ç½®</button>
                <button class="btn btn-primary" onclick="applyConfig()">âœ… ä¿å­˜å¹¶åº”ç”¨ï¼ˆéœ€é‡å¯æœåŠ¡ï¼‰</button>
                <button class="btn btn-secondary" onclick="resetConfig()">ğŸ”„ é‡ç½®ä¸ºé»˜è®¤å€¼</button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        const API_BASE = window.location.origin;
        let currentTab = 'home';

        // é…ç½®å­—æ®µåˆ—è¡¨
        const CONFIG_FIELDS = [
            'MODEL_PROVIDER', 'AUTO_MODEL_SELECTION', 'PREFER_MODEL', 'IMAGE_MODEL',
            'DEEPSEEK_API_KEY', 'DEEPSEEK_BASE_URL', 'DEEPSEEK_MODEL',
            'DOUBAO_API_KEY', 'DOUBAO_BASE_URL', 'DOUBAO_MODEL',
            'ENABLE_REASONING', 'REASONING_EFFORT', 'AUTO_REASONING_FOR_MULTIPLE', 'AUTO_REASONING_FOR_IMAGES',
            'TEMPERATURE', 'MAX_TOKENS', 'REASONING_MAX_TOKENS', 'TOP_P',
            'HTTP_PROXY', 'HTTPS_PROXY', 'TIMEOUT', 'MAX_RETRIES',
            'HOST', 'PORT', 'DEBUG', 'CSV_LOG_FILE', 'LOG_LEVEL'
        ];

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = function() {
            loadConfig();
            checkServiceStatus();
            // æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡æœåŠ¡çŠ¶æ€
            setInterval(checkServiceStatus, 30000);
        };

        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µ
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µ
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            currentTab = tabName;

            // å¦‚æœåˆ‡æ¢åˆ°é¢„è§ˆé¡µ,åˆ·æ–°é¢„è§ˆ
            if (tabName === 'preview') {
                generatePreview();
            }
        }

        // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
        function showAlert(message, type = 'success') {
            const container = document.getElementById('alert-container');
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.textContent = message;
            alert.style.display = 'block';
            
            container.innerHTML = '';
            container.appendChild(alert);
            
            setTimeout(() => {
                alert.style.display = 'none';
            }, 5000);
        }

        // åŠ è½½é…ç½®
        async function loadConfig() {
            try {
                const response = await fetch(`${API_BASE}/api/config`);
                if (!response.ok) throw new Error('åŠ è½½é…ç½®å¤±è´¥');
                
                const config = await response.json();
                
                // å¡«å……è¡¨å•
                CONFIG_FIELDS.forEach(field => {
                    const element = document.getElementById(field);
                    if (!element) return;
                    
                    const value = config[field];
                    
                    if (element.type === 'checkbox') {
                        element.checked = value === 'true' || value === true;
                    } else {
                        element.value = value || '';
                    }
                });

                // æ›´æ–°é¦–é¡µçŠ¶æ€
                updateHomeStatus(config);
                
                showAlert('é…ç½®åŠ è½½æˆåŠŸ', 'success');
            } catch (error) {
                console.error('åŠ è½½é…ç½®å¤±è´¥:', error);
                showAlert('åŠ è½½é…ç½®å¤±è´¥: ' + error.message, 'error');
            }
        }

        // æ›´æ–°é¦–é¡µçŠ¶æ€æ˜¾ç¤º
        function updateHomeStatus(config) {
            document.getElementById('service-url').textContent = `${API_BASE}`;
            document.getElementById('current-model').textContent = config.MODEL_PROVIDER || 'auto';
            document.getElementById('reasoning-status').textContent = 
                (config.ENABLE_REASONING === 'true' || config.ENABLE_REASONING === true) ? 'âœ… å·²å¯ç”¨' : 'âŒ æœªå¯ç”¨';
        }

        // æ£€æŸ¥æœåŠ¡çŠ¶æ€
        async function checkServiceStatus() {
            try {
                const response = await fetch(`${API_BASE}/?t=${Date.now()}`, { method: 'HEAD' });
                const badge = document.getElementById('status-badge');
                
                if (response.ok) {
                    badge.className = 'status-badge status-online';
                    badge.textContent = 'ğŸŸ¢ è¿è¡Œä¸­';
                } else {
                    badge.className = 'status-badge status-offline';
                    badge.textContent = 'ğŸ”´ å¼‚å¸¸';
                }
            } catch (error) {
                const badge = document.getElementById('status-badge');
                badge.className = 'status-badge status-offline';
                badge.textContent = 'ğŸ”´ ç¦»çº¿';
            }
        }

        // ä¿å­˜é…ç½®
        async function saveConfig() {
            const config = {};
            
            CONFIG_FIELDS.forEach(field => {
                const element = document.getElementById(field);
                if (!element) return;
                
                if (element.type === 'checkbox') {
                    config[field] = element.checked ? 'true' : 'false';
                } else {
                    config[field] = element.value;
                }
            });

            try {
                const response = await fetch(`${API_BASE}/api/config`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(config)
                });

                if (!response.ok) throw new Error('ä¿å­˜é…ç½®å¤±è´¥');
                
                const result = await response.json();
                showAlert('é…ç½®ä¿å­˜æˆåŠŸï¼è¯·é‡å¯æœåŠ¡ä»¥åº”ç”¨æ–°é…ç½®ã€‚', 'success');
            } catch (error) {
                console.error('ä¿å­˜é…ç½®å¤±è´¥:', error);
                showAlert('ä¿å­˜é…ç½®å¤±è´¥: ' + error.message, 'error');
            }
        }

        // ä¿å­˜å¹¶åº”ç”¨é…ç½®
        async function applyConfig() {
            await saveConfig();
            showAlert('é…ç½®å·²ä¿å­˜ï¼è¯·æ‰‹åŠ¨é‡å¯æœåŠ¡ä»¥åº”ç”¨æ–°é…ç½®ï¼ˆå…³é—­å½“å‰æœåŠ¡åé‡æ–°è¿è¡Œ start.batï¼‰', 'warning');
        }

        // é‡ç½®é…ç½®
        function resetConfig() {
            if (!confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰é…ç½®ä¸ºé»˜è®¤å€¼å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼')) return;
            
            // é‡ç½®ä¸ºé»˜è®¤å€¼
            const defaults = {
                MODEL_PROVIDER: 'auto',
                AUTO_MODEL_SELECTION: true,
                PREFER_MODEL: 'deepseek',
                IMAGE_MODEL: 'doubao',
                DEEPSEEK_BASE_URL: 'https://api.deepseek.com',
                DEEPSEEK_MODEL: 'deepseek-chat',
                DOUBAO_BASE_URL: 'https://ark.cn-beijing.volces.com/api/v3',
                DOUBAO_MODEL: 'doubao-seed-1-6-251015',
                ENABLE_REASONING: false,
                REASONING_EFFORT: 'medium',
                AUTO_REASONING_FOR_MULTIPLE: true,
                AUTO_REASONING_FOR_IMAGES: true,
                TEMPERATURE: '0.1',
                MAX_TOKENS: '500',
                REASONING_MAX_TOKENS: '4096',
                TOP_P: '0.95',
                TIMEOUT: '180.0',
                MAX_RETRIES: '3',
                HOST: '0.0.0.0',
                PORT: '5000',
                DEBUG: false,
                CSV_LOG_FILE: 'ocs_answers_log.csv',
                LOG_LEVEL: 'INFO'
            };

            CONFIG_FIELDS.forEach(field => {
                const element = document.getElementById(field);
                if (!element) return;
                
                const value = defaults[field];
                
                if (element.type === 'checkbox') {
                    element.checked = value === true;
                } else {
                    element.value = value || '';
                }
            });

            showAlert('é…ç½®å·²é‡ç½®ä¸ºé»˜è®¤å€¼ï¼ˆæœªä¿å­˜ï¼Œè¯·ç‚¹å‡»"ä¿å­˜é…ç½®"æŒ‰é’®ï¼‰', 'warning');
        }

        // ç”Ÿæˆé…ç½®é¢„è§ˆ
        function generatePreview() {
            const config = {};
            
            CONFIG_FIELDS.forEach(field => {
                const element = document.getElementById(field);
                if (!element) return;
                
                if (element.type === 'checkbox') {
                    config[field] = element.checked ? 'true' : 'false';
                } else {
                    config[field] = element.value;
                }
            });

            // ç”Ÿæˆ.envæ ¼å¼
            let envContent = '# OCS AI Answerer é…ç½®æ–‡ä»¶\n';
            envContent += '# ç”±é…ç½®é¢æ¿ç”Ÿæˆäº: ' + new Date().toLocaleString('zh-CN') + '\n\n';
            
            envContent += '# ==================== æ¨¡å‹é…ç½® ====================\n';
            envContent += `MODEL_PROVIDER=${config.MODEL_PROVIDER}\n\n`;
            
            envContent += '# ==================== æ™ºèƒ½æ¨¡å‹é€‰æ‹© ====================\n';
            envContent += `AUTO_MODEL_SELECTION=${config.AUTO_MODEL_SELECTION}\n`;
            envContent += `PREFER_MODEL=${config.PREFER_MODEL}\n`;
            envContent += `IMAGE_MODEL=${config.IMAGE_MODEL}\n\n`;
            
            envContent += '# ==================== DeepSeeké…ç½® ====================\n';
            envContent += `DEEPSEEK_API_KEY=${config.DEEPSEEK_API_KEY}\n`;
            envContent += `DEEPSEEK_BASE_URL=${config.DEEPSEEK_BASE_URL}\n`;
            envContent += `DEEPSEEK_MODEL=${config.DEEPSEEK_MODEL}\n\n`;
            
            envContent += '# ==================== è±†åŒ…é…ç½® ====================\n';
            envContent += `DOUBAO_API_KEY=${config.DOUBAO_API_KEY}\n`;
            envContent += `DOUBAO_BASE_URL=${config.DOUBAO_BASE_URL}\n`;
            envContent += `DOUBAO_MODEL=${config.DOUBAO_MODEL}\n\n`;
            
            envContent += '# ==================== æ€è€ƒæ¨¡å¼ ====================\n';
            envContent += `ENABLE_REASONING=${config.ENABLE_REASONING}\n`;
            envContent += `REASONING_EFFORT=${config.REASONING_EFFORT}\n`;
            envContent += `AUTO_REASONING_FOR_MULTIPLE=${config.AUTO_REASONING_FOR_MULTIPLE}\n`;
            envContent += `AUTO_REASONING_FOR_IMAGES=${config.AUTO_REASONING_FOR_IMAGES}\n\n`;
            
            envContent += '# ==================== AIå‚æ•° ====================\n';
            envContent += `TEMPERATURE=${config.TEMPERATURE}\n`;
            envContent += `MAX_TOKENS=${config.MAX_TOKENS}\n`;
            envContent += `REASONING_MAX_TOKENS=${config.REASONING_MAX_TOKENS}\n`;
            envContent += `TOP_P=${config.TOP_P}\n\n`;
            
            envContent += '# ==================== ç½‘ç»œé…ç½® ====================\n';
            envContent += `HTTP_PROXY=${config.HTTP_PROXY}\n`;
            envContent += `HTTPS_PROXY=${config.HTTPS_PROXY}\n`;
            envContent += `TIMEOUT=${config.TIMEOUT}\n`;
            envContent += `MAX_RETRIES=${config.MAX_RETRIES}\n\n`;
            
            envContent += '# ==================== æœåŠ¡é…ç½® ====================\n';
            envContent += `HOST=${config.HOST}\n`;
            envContent += `PORT=${config.PORT}\n`;
            envContent += `DEBUG=${config.DEBUG}\n`;
            envContent += `LOG_LEVEL=${config.LOG_LEVEL}\n\n`;
            
            envContent += '# ==================== CSVæ—¥å¿—é…ç½® ====================\n';
            envContent += `CSV_LOG_FILE=${config.CSV_LOG_FILE}\n`;

            document.getElementById('config-preview').textContent = envContent;
        }

        // å¤åˆ¶é…ç½®
        function copyConfig() {
            const preview = document.getElementById('config-preview').textContent;
            navigator.clipboard.writeText(preview).then(() => {
                showAlert('é…ç½®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            }).catch(err => {
                showAlert('å¤åˆ¶å¤±è´¥: ' + err.message, 'error');
            });
        }

        // ä¸‹è½½é…ç½®
        function downloadConfig() {
            const preview = document.getElementById('config-preview').textContent;
            const blob = new Blob([preview], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = '.env';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showAlert('é…ç½®æ–‡ä»¶å·²ä¸‹è½½', 'success');
        }

        // æµ‹è¯•è¿æ¥
        async function testConnection() {
            showAlert('æ­£åœ¨æµ‹è¯•è¿æ¥...', 'warning');
            try {
                const start = Date.now();
                const response = await fetch(`${API_BASE}/?t=${Date.now()}`);
                const latency = Date.now() - start;
                
                if (response.ok) {
                    showAlert(`è¿æ¥æˆåŠŸï¼å»¶è¿Ÿ: ${latency}ms`, 'success');
                } else {
                    showAlert('è¿æ¥å¤±è´¥: æœåŠ¡å™¨è¿”å›é”™è¯¯', 'error');
                }
            } catch (error) {
                showAlert('è¿æ¥å¤±è´¥: ' + error.message, 'error');
            }
        }
    </script>
</body>
</html>
